{"componentChunkName":"component---src-templates-info-page-template-js","path":"/2-design","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An essential part of TDD is "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/DefinitionOfRefactoring.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"refactoring"}]},{"type":"text","value":": improving the structure of the code without changing its observable behavior. TDD's tests provide a feedback mechanism: if something is hard to test, it means the code's design needs improvement. When learning TDD, listening to your tests and learning about design is what takes the longest."}]},{"type":"element","tagName":"h2","properties":{"id":"evolutionary-design","style":"position:relative;"},"children":[{"type":"text","value":"Evolutionary design"},{"type":"element","tagName":"a","properties":{"href":"#evolutionary-design","ariaLabel":"evolutionary design permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"aka incremental design, aka continuous design"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Designing a whole system up-front without mistakes is impossible. At the start of a project is the time when we know the least about the problem we are solving. That's why our design must evolve as we learn more. We put our learning back into the program by modifying it to look "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"as if we had know what we were doing all along, and as if had been easy to do."}]},{"type":"text","value":" "},{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=pqeJFYwnkjE","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[1]"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We should "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"start with an idea of a design, but assume it's wrong."}]},{"type":"text","value":" "},{"type":"element","tagName":"a","properties":{"href":"https://youtu.be/Hybt9NdmsBw?t=100","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[2]"}]},{"type":"text","value":" We'll continually look for signs that our current design doesn't fit the problem, and then we'll modify the design to fit it better."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But we shouldn't build flexible and reusable components up-front. They would increase complexity and anyway might not flex in the right direction. Instead, we'll follow the principles of "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/Yagni.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"YAGNI"}]},{"type":"text","value":" and "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/BeckDesignRules.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Simple Design"}]},{"type":"text","value":" to reduce the friction of changing our design into "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"any"}]},{"type":"text","value":" direction."}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://jhall.io/archive/2022/10/27/whats-the-relationship-between-tdd-and-evolutionary-design/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"What's the relationship between TDD and Evolutionary Design?"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=pqeJFYwnkjE","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Debt Metaphor"}]},{"type":"text","value":" - about putting our learning back into the program"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.martinfowler.com/articles/designDead.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Is Design Dead?"}]},{"type":"text","value":" - about evolutionary design and how the XP practices enable it"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"four-elements-of-simple-design","style":"position:relative;"},"children":[{"type":"text","value":"Four elements of simple design"},{"type":"element","tagName":"a","properties":{"href":"#four-elements-of-simple-design","ariaLabel":"four elements of simple design permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In priority order:"}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Passes its tests"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Minimizes duplication"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Maximizes clarity"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Has fewer elements"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With TDD, point 1 is a given. If points 2 and 3 are covered, then point 4 rarely comes up. The order between 2 and 3 is debatable. Thus, the rules can be summarized:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Remove duplication"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Improve names"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Keep practicing these, and in a few decades every other design principle and pattern will emerge."}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://blog.jbrains.ca/permalink/the-four-elements-of-simple-design","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"The Four Elements of Simple Design"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/BeckDesignRules.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Kent Beck's Design Rules"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/Yagni.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"YAGNI: You Aren't Gonna Need It"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"duplication","style":"position:relative;"},"children":[{"type":"text","value":"Duplication"},{"type":"element","tagName":"a","properties":{"href":"#duplication","ariaLabel":"duplication permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Don't Repeat Yourself"}]},{"type":"text","value":" (DRY) principle says:"}]},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Every piece of knowledge must have a single, unambiguous, authoritative representation within a system."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"- Andy Hunt and Dave Thomas, The Pragmatic Programmer (1999)"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The alternative is to have the same thing expressed in two or more places. Then if you need to change one place, you might accidentally not remember to change the other place, leading to problems."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A common case of duplicated knowledge is similar code in two or more places. If the places are "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"almost"}]},{"type":"text","value":" similar, first try to refactor them to be exactly the same code, after which it's easier to extract the common code to a shared function."}]},{"type":"element","tagName":"h3","properties":{"id":"three-strikes-and-you-refactor","style":"position:relative;"},"children":[{"type":"text","value":"Three strikes and you refactor"},{"type":"element","tagName":"a","properties":{"href":"#three-strikes-and-you-refactor","ariaLabel":"three strikes and you refactor permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"aka rule of three"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If it's not yet obvious that in what way the duplicated code will vary from place to place, let the code fester/ripen a bit longer. Wait until the code is repeated in three places, and "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"then"}]},{"type":"text","value":" refactor. This reduces the risk of creating the wrong abstraction. "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[1]"}]}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://blog.thecodewhisperer.com/permalink/when-should-i-remove-duplication","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"When should I remove duplication?"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h3","properties":{"id":"naive-duplication","style":"position:relative;"},"children":[{"type":"text","value":"Naive duplication"},{"type":"element","tagName":"a","properties":{"href":"#naive-duplication","ariaLabel":"naive duplication permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Not all code that looks similar is duplicated knowledge. Even if chairs and dogs both have 4 legs, the 4s are not related."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Conway's Game of Life"}]},{"type":"text","value":", the calculation of whether a cell will be alive in the next generation could be written like this:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"pseudo"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-pseudo"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-pseudo"]},"children":[{"type":"text","value":"will_live? = if alive?\n                 neighbors == 2 || neighbors == 3\n             else\n                 neighbors == 3"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"neighbors == 3"}]},{"type":"text","value":" is repeated, so let's remove the duplication:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"pseudo"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-pseudo"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-pseudo"]},"children":[{"type":"text","value":"will_live? = (alive? && neighbors == 2) || neighbors == 3"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But this is wrong. It couples together two unrelated concepts:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the original code, the 2 and 3 in the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"alive?"}]},{"type":"text","value":" branch are related to the concept of a \"stable neighborhood\", whereas the 3 in the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"not alive?"}]},{"type":"text","value":" branch means \"genetically fertile neighborhood\"."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"By naming these concepts it becomes clear that they are not actually duplicated:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"pseudo"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-pseudo"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-pseudo"]},"children":[{"type":"text","value":"will_live? = if alive?\n                 stable_neighborhood?\n             else\n                 genetically_fertile_neighborhood?"}]}]}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"This example was from the book "},{"type":"element","tagName":"a","properties":{"href":"https://leanpub.com/4rulesofsimpledesign","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Understanding the Four Rules of Simple Design"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"naming-things","style":"position:relative;"},"children":[{"type":"text","value":"Naming things"},{"type":"element","tagName":"a","properties":{"href":"#naming-things","ariaLabel":"naming things permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There are only two hard things in Computer Science: cache invalidation and naming things."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"- Phil Karlton "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/TwoHardThings.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[1]"}]}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Removing duplication and improving names feed into each other in a virtuous cycle."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Naming is a process: nonsense → accurate-but-vague → precise → meaningful. Never stop improving."}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://agileinaflash.blogspot.com/2009/02/meaningful-names.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Meaningful Names"}]},{"type":"text","value":" - a summary of chapter 2 of the "},{"type":"element","tagName":"a","properties":{"href":"https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Clean Code"}]},{"type":"text","value":" book"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://blog.thecodewhisperer.com/permalink/a-model-for-improving-names","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"A Model for Improving Names"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.digdeeproots.com/articles/on/naming-process/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Naming as a Process"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"composed-method","style":"position:relative;"},"children":[{"type":"text","value":"Composed method"},{"type":"element","tagName":"a","properties":{"href":"#composed-method","ariaLabel":"composed method permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Divide your program into methods that perform one identifiable task. Keep all of the operations in a method at the same level of abstraction. This will naturally result in programs with many small methods, each a few lines long."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"- Kent Beck, Smalltalk Best Practice Patterns (1996) "},{"type":"element","tagName":"a","properties":{"href":"https://wiki.c2.com/?ComposedMethod","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[1]"}]}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Each new method is an opportunity to introduce a new name."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The code should read like a newspaper article. First the high-level overview, then dig deeper into more details."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Keep in mind that each refactoring can be done in two directions: If you inline everything into one big method, it may be possible to see a different way to split it into small methods."}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://farenda.com/posts/composed-method-pattern/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Composed Method Pattern explained"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/jnguyen095/clean-code/issues/28","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"The Newspaper Metaphor"}]},{"type":"text","value":" - an excerpt from chapter 5 of the "},{"type":"element","tagName":"a","properties":{"href":"https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Clean Code"}]},{"type":"text","value":" book"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"small-safe-steps","style":"position:relative;"},"children":[{"type":"text","value":"Small, safe steps"},{"type":"element","tagName":"a","properties":{"href":"#small-safe-steps","ariaLabel":"small safe steps permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To do a refactoring with far-reaching consequences, you have two options:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"One big change:"}]},{"type":"text","value":" Carefully analyze the whole codebase to figure out every place that must be changed, and then change all those places at the same time. It may take hours to read the codebase and you could still miss some side-effect. When tests break after your changes, the problem could be anywhere in the codebase."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Many small changes:"}]},{"type":"text","value":" Plan a series of changes, each of which can be proven through local reasoning to not change behavior. Start the refactoring from one place and propagate it in tiny increments by making mechanical changes which require very little thinking. There could be 10 or 100 times more steps, but each of them takes just a couple seconds. When tests break after your changes, the problem should be near the line you changed 5 seconds ago."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Many small changes is faster than one big change."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When you refactor, don't change behavior. When you change behavior, don't refactor. Maintain three points of contact like a mountain climber. 🧗"}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.infoq.com/presentations/responsive-design/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Responsive Design"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h3","properties":{"id":"refactoring-hell","style":"position:relative;"},"children":[{"type":"text","value":"Refactoring hell"},{"type":"element","tagName":"a","properties":{"href":"#refactoring-hell","ariaLabel":"refactoring hell permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If it's been more than a few minutes since the tests last passed, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"git reset --hard"}]},{"type":"text","value":" and try again using smaller steps."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"(Your IDE's "},{"type":"element","tagName":"a","properties":{"href":"https://www.jetbrains.com/help/idea/local-history.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"local history"}]},{"type":"text","value":" may also show when all tests last passed, so you can revert to that point in time.)"}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://wiki.c2.com/?RefactoringHell","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Refactoring Hell"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"four-strategies","style":"position:relative;"},"children":[{"type":"text","value":"Four strategies"},{"type":"element","tagName":"a","properties":{"href":"#four-strategies","ariaLabel":"four strategies permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There are four strategies to refactor and design using small, safe steps:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Leap:"}]},{"type":"text","value":" The change is small enough. Just do it."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Parallel:"}]},{"type":"text","value":" Build the new solution side-by-side with the old solution, until the new can replace the old."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Stepping stone:"}]},{"type":"text","value":" You want to build thing A, but if you built thing B first, that could make it easier to build thing A. (Beware of gold plating.)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Simplification:"}]},{"type":"text","value":" Solve a trivialized version of the problem first. 1×1 sudoku."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Design is scale-free. The "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"parallel change"}]},{"type":"text","value":" strategy works the same way regardless of whether we're adding a new field to a class, or replacing the healthcare software system of a city."}]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.infoq.com/presentations/responsive-design/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Responsive Design"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"test-quality","style":"position:relative;"},"children":[{"type":"text","value":"Test quality"},{"type":"element","tagName":"a","properties":{"href":"#test-quality","ariaLabel":"test quality permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tests should be sensitive to behavior changes and insensitive to structure changes."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Each test should test only one thing."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Each bug should cause only one test to fail."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From the pattern of failing tests, it should be possible to guess in which function or line the problem is."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If some code can be commented out and no test fails, the code should be dead."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In five seconds you will have forgotten over half of your "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Working_memory","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"working memory"}]},{"type":"text","value":". Make the tests so fast that you won't forget what you were thinking."}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":"margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 70.86956521739131%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVR42pWSVw6DQAxE9/5nBIkOorfQCXlgglCKQvyBjHdnPGOvWpal7/skSbquu23RNE1d15J8rLRtWxQFXwW4LEvTNEnmeb5fCG4Kywr2PM+2bZDL5UAmeJWmKRpojozr+B3sOE4YhliapgklF8F0WmVHUYRmmlPifxiGPzpbllVVFRklhuH7PqzHYH6ANU3TdT3LMgGzNg7Ax3Gc57lcfSfaZbOkc+fjGBbZ7TiOXztzA9vi+V0t8wcfBMELxd6ZjG3R/KO8w0v7DGGRihINeGZVlIZTcE8SjsYtGCd7RTDvynXdFQwS5zBVW3DGtHjt5DweKRqGgTV5/ziFArwSYXC/WKXILFgk3WRsZ1PkKHoArP0w5Q4jD5oAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/460a7c0c4db93ce8d1fe133754cd3c0e/a0b58/working-memory-decay.webp 230w","/static/460a7c0c4db93ce8d1fe133754cd3c0e/bc10c/working-memory-decay.webp 460w","/static/460a7c0c4db93ce8d1fe133754cd3c0e/9cb26/working-memory-decay.webp 539w"],"sizes":"(max-width: 539px) 100vw, 539px","type":"image/webp"},"children":[]},{"type":"text","value":"\n          "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/460a7c0c4db93ce8d1fe133754cd3c0e/81c8e/working-memory-decay.png 230w","/static/460a7c0c4db93ce8d1fe133754cd3c0e/08a84/working-memory-decay.png 460w","/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png 539w"],"sizes":"(max-width: 539px) 100vw, 539px","type":"image/png"},"children":[]},{"type":"text","value":"\n          "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png","alt":"Decay of working memory if rehearsal is prevented. The time scale is of the order of a few seconds.","title":"How quickly working memory decays when you think of something else. [[1]](https://www.researchgate.net/figure/Decay-of-working-memory-if-rehearsal-is-prevented-The-time-scale-is-of-the-order-of-a_fig7_35883885)","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"How quickly working memory decays when you think of something else. "},{"type":"element","tagName":"a","properties":{"href":"https://www.researchgate.net/figure/Decay-of-working-memory-if-rehearsal-is-prevented-The-time-scale-is-of-the-order-of-a_fig7_35883885","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"[1]"}]}]}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"recommended-reading","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://agileinaflash.blogspot.com/2009/02/first.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"F.I.R.S.T properties of unit tests"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://medium.com/@kentbeck_7670/programmer-test-principles-d01c064d7934","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Programmer Test Principles"}]}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h3","properties":{"id":"test-smells","style":"position:relative;"},"children":[{"type":"text","value":"Test smells"},{"type":"element","tagName":"a","properties":{"href":"#test-smells","ariaLabel":"test smells permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Like there are "},{"type":"element","tagName":"a","properties":{"href":"https://refactoring.guru/refactoring/smells","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"many code smells"}]},{"type":"text","value":", there are also "},{"type":"element","tagName":"a","properties":{"href":"http://xunitpatterns.com/TestSmells.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"test smells"}]},{"type":"text","value":". Here are a couple to look out for:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Many asserts per test:"}]},{"type":"text","value":" Normally tests are structured in the "},{"type":"element","tagName":"a","properties":{"href":"https://agileinaflash.blogspot.com/2009/03/arrange-act-assert.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Arrange-Act-Assert"}]},{"type":"text","value":"/"},{"type":"element","tagName":"a","properties":{"href":"https://dannorth.net/introducing-bdd/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Given-When-Then"}]},{"type":"text","value":"/"},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Hoare_logic","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Hoare Triple"}]},{"type":"text","value":" format. But if they are instead "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Arrange-Act-Assert-Act-Assert-Act..."}]},{"type":"text","value":", that usually indicates that a test is lacking focus and testing many different things (making the test's purpose harder to decipher), or that it's testing "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"how"}]},{"type":"text","value":" the system does things instead of testing "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"what"}]},{"type":"text","value":" the system does (making refactoring harder). Depending on the testing framework, earlier test failures may also mask later test failures, making it harder to know why the test failed. Instead, write many small, focused tests."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Complex test setup:"}]},{"type":"text","value":" If the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"arrange"}]},{"type":"text","value":" part of a test is long, requiring the careful arrangement of many collaborators to get the system into the desired initial state for the test, it may indicate design problems in the code. Lots of constructor arguments is a similar smell (which is why dependency injection frameworks are best avoided - they make it too easy to add dependencies). Instead, try to think of a design which eliminates some of the dependencies."}]},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Proceed to "},{"type":"element","tagName":"a","properties":{"href":"/3-challenges"},"children":[{"type":"text","value":"Chapter 3: The Untestables"}]},{"type":"text","value":" or "},{"type":"element","tagName":"a","properties":{"href":"/exercises"},"children":[{"type":"text","value":"Exercises"}]}]}]},"html":"<div><p>An essential part of TDD is <a href=\"https://martinfowler.com/bliki/DefinitionOfRefactoring.html\" target=\"_blank\" rel=\"noopener noreferrer\">refactoring</a>: improving the structure of the code without changing its observable behavior. TDD's tests provide a feedback mechanism: if something is hard to test, it means the code's design needs improvement. When learning TDD, listening to your tests and learning about design is what takes the longest.</p><h2 id=\"evolutionary-design\" style=\"position:relative;\">Evolutionary design<a href=\"#evolutionary-design\" aria-label=\"evolutionary design permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p><em>aka incremental design, aka continuous design</em></p><p>Designing a whole system up-front without mistakes is impossible. At the start of a project is the time when we know the least about the problem we are solving. That's why our design must evolve as we learn more. We put our learning back into the program by modifying it to look <em>as if we had know what we were doing all along, and as if had been easy to do.</em> <a href=\"https://www.youtube.com/watch?v=pqeJFYwnkjE\" target=\"_blank\" rel=\"noopener noreferrer\">[1]</a></p><p>We should <em>start with an idea of a design, but assume it's wrong.</em> <a href=\"https://youtu.be/Hybt9NdmsBw?t=100\" target=\"_blank\" rel=\"noopener noreferrer\">[2]</a> We'll continually look for signs that our current design doesn't fit the problem, and then we'll modify the design to fit it better.</p><p>But we shouldn't build flexible and reusable components up-front. They would increase complexity and anyway might not flex in the right direction. Instead, we'll follow the principles of <a href=\"https://martinfowler.com/bliki/Yagni.html\" target=\"_blank\" rel=\"noopener noreferrer\">YAGNI</a> and <a href=\"https://martinfowler.com/bliki/BeckDesignRules.html\" target=\"_blank\" rel=\"noopener noreferrer\">Simple Design</a> to reduce the friction of changing our design into <em>any</em> direction.</p><recommended-reading><ul>\n<li><a href=\"https://jhall.io/archive/2022/10/27/whats-the-relationship-between-tdd-and-evolutionary-design/\" target=\"_blank\" rel=\"noopener noreferrer\">What's the relationship between TDD and Evolutionary Design?</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=pqeJFYwnkjE\" target=\"_blank\" rel=\"noopener noreferrer\">Debt Metaphor</a> - about putting our learning back into the program</li>\n<li><a href=\"https://www.martinfowler.com/articles/designDead.html\" target=\"_blank\" rel=\"noopener noreferrer\">Is Design Dead?</a> - about evolutionary design and how the XP practices enable it</li>\n</ul></recommended-reading><h2 id=\"four-elements-of-simple-design\" style=\"position:relative;\">Four elements of simple design<a href=\"#four-elements-of-simple-design\" aria-label=\"four elements of simple design permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>In priority order:</p><ol>\n<li>Passes its tests</li>\n<li>Minimizes duplication</li>\n<li>Maximizes clarity</li>\n<li>Has fewer elements</li>\n</ol><p>With TDD, point 1 is a given. If points 2 and 3 are covered, then point 4 rarely comes up. The order between 2 and 3 is debatable. Thus, the rules can be summarized:</p><ul>\n<li>Remove duplication</li>\n<li>Improve names</li>\n</ul><p>Keep practicing these, and in a few decades every other design principle and pattern will emerge.</p><recommended-reading><ul>\n<li><a href=\"https://blog.jbrains.ca/permalink/the-four-elements-of-simple-design\" target=\"_blank\" rel=\"noopener noreferrer\">The Four Elements of Simple Design</a></li>\n<li><a href=\"https://martinfowler.com/bliki/BeckDesignRules.html\" target=\"_blank\" rel=\"noopener noreferrer\">Kent Beck's Design Rules</a></li>\n<li><a href=\"https://martinfowler.com/bliki/Yagni.html\" target=\"_blank\" rel=\"noopener noreferrer\">YAGNI: You Aren't Gonna Need It</a></li>\n</ul></recommended-reading><h2 id=\"duplication\" style=\"position:relative;\">Duplication<a href=\"#duplication\" aria-label=\"duplication permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>The <em>Don't Repeat Yourself</em> (DRY) principle says:</p><blockquote>\n<p>Every piece of knowledge must have a single, unambiguous, authoritative representation within a system.</p>\n<p>- Andy Hunt and Dave Thomas, The Pragmatic Programmer (1999)</p>\n</blockquote><p>The alternative is to have the same thing expressed in two or more places. Then if you need to change one place, you might accidentally not remember to change the other place, leading to problems.</p><p>A common case of duplicated knowledge is similar code in two or more places. If the places are <em>almost</em> similar, first try to refactor them to be exactly the same code, after which it's easier to extract the common code to a shared function.</p><h3 id=\"three-strikes-and-you-refactor\" style=\"position:relative;\">Three strikes and you refactor<a href=\"#three-strikes-and-you-refactor\" aria-label=\"three strikes and you refactor permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p><em>aka rule of three</em></p><p>If it's not yet obvious that in what way the duplicated code will vary from place to place, let the code fester/ripen a bit longer. Wait until the code is repeated in three places, and <em>then</em> refactor. This reduces the risk of creating the wrong abstraction. <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)\" target=\"_blank\" rel=\"noopener noreferrer\">[1]</a></p><recommended-reading><ul>\n<li><a href=\"https://blog.thecodewhisperer.com/permalink/when-should-i-remove-duplication\" target=\"_blank\" rel=\"noopener noreferrer\">When should I remove duplication?</a></li>\n</ul></recommended-reading><h3 id=\"naive-duplication\" style=\"position:relative;\">Naive duplication<a href=\"#naive-duplication\" aria-label=\"naive duplication permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>Not all code that looks similar is duplicated knowledge. Even if chairs and dogs both have 4 legs, the 4s are not related.</p><p>In <a href=\"https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life\" target=\"_blank\" rel=\"noopener noreferrer\">Conway's Game of Life</a>, the calculation of whether a cell will be alive in the next generation could be written like this:</p><div class=\"gatsby-highlight\" data-language=\"pseudo\"><pre class=\"language-pseudo\"><code class=\"language-pseudo\">will_live? = if alive?\n                 neighbors == 2 || neighbors == 3\n             else\n                 neighbors == 3</code></pre></div><p>The <code class=\"language-text\">neighbors == 3</code> is repeated, so let's remove the duplication:</p><div class=\"gatsby-highlight\" data-language=\"pseudo\"><pre class=\"language-pseudo\"><code class=\"language-pseudo\">will_live? = (alive? &amp;&amp; neighbors == 2) || neighbors == 3</code></pre></div><p>But this is wrong. It couples together two unrelated concepts:</p><p>In the original code, the 2 and 3 in the <code class=\"language-text\">alive?</code> branch are related to the concept of a \"stable neighborhood\", whereas the 3 in the <code class=\"language-text\">not alive?</code> branch means \"genetically fertile neighborhood\".</p><p>By naming these concepts it becomes clear that they are not actually duplicated:</p><div class=\"gatsby-highlight\" data-language=\"pseudo\"><pre class=\"language-pseudo\"><code class=\"language-pseudo\">will_live? = if alive?\n                 stable_neighborhood?\n             else\n                 genetically_fertile_neighborhood?</code></pre></div><recommended-reading><ul>\n<li>This example was from the book <a href=\"https://leanpub.com/4rulesofsimpledesign\" target=\"_blank\" rel=\"noopener noreferrer\">Understanding the Four Rules of Simple Design</a></li>\n</ul></recommended-reading><h2 id=\"naming-things\" style=\"position:relative;\">Naming things<a href=\"#naming-things\" aria-label=\"naming things permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><blockquote>\n<p>There are only two hard things in Computer Science: cache invalidation and naming things.</p>\n<p>- Phil Karlton <a href=\"https://martinfowler.com/bliki/TwoHardThings.html\" target=\"_blank\" rel=\"noopener noreferrer\">[1]</a></p>\n</blockquote><p>Removing duplication and improving names feed into each other in a virtuous cycle.</p><p>Naming is a process: nonsense → accurate-but-vague → precise → meaningful. Never stop improving.</p><recommended-reading><ul>\n<li><a href=\"https://agileinaflash.blogspot.com/2009/02/meaningful-names.html\" target=\"_blank\" rel=\"noopener noreferrer\">Meaningful Names</a> - a summary of chapter 2 of the <a href=\"https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882\" target=\"_blank\" rel=\"noopener noreferrer\">Clean Code</a> book</li>\n<li><a href=\"https://blog.thecodewhisperer.com/permalink/a-model-for-improving-names\" target=\"_blank\" rel=\"noopener noreferrer\">A Model for Improving Names</a></li>\n<li><a href=\"https://www.digdeeproots.com/articles/on/naming-process/\" target=\"_blank\" rel=\"noopener noreferrer\">Naming as a Process</a></li>\n</ul></recommended-reading><h2 id=\"composed-method\" style=\"position:relative;\">Composed method<a href=\"#composed-method\" aria-label=\"composed method permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><blockquote>\n<p>Divide your program into methods that perform one identifiable task. Keep all of the operations in a method at the same level of abstraction. This will naturally result in programs with many small methods, each a few lines long.</p>\n<p>- Kent Beck, Smalltalk Best Practice Patterns (1996) <a href=\"https://wiki.c2.com/?ComposedMethod\" target=\"_blank\" rel=\"noopener noreferrer\">[1]</a></p>\n</blockquote><p>Each new method is an opportunity to introduce a new name.</p><p>The code should read like a newspaper article. First the high-level overview, then dig deeper into more details.</p><p>Keep in mind that each refactoring can be done in two directions: If you inline everything into one big method, it may be possible to see a different way to split it into small methods.</p><recommended-reading><ul>\n<li><a href=\"https://farenda.com/posts/composed-method-pattern/\" target=\"_blank\" rel=\"noopener noreferrer\">Composed Method Pattern explained</a></li>\n<li><a href=\"https://github.com/jnguyen095/clean-code/issues/28\" target=\"_blank\" rel=\"noopener noreferrer\">The Newspaper Metaphor</a> - an excerpt from chapter 5 of the <a href=\"https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882\" target=\"_blank\" rel=\"noopener noreferrer\">Clean Code</a> book</li>\n</ul></recommended-reading><h2 id=\"small-safe-steps\" style=\"position:relative;\">Small, safe steps<a href=\"#small-safe-steps\" aria-label=\"small safe steps permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>To do a refactoring with far-reaching consequences, you have two options:</p><ul>\n<li><strong>One big change:</strong> Carefully analyze the whole codebase to figure out every place that must be changed, and then change all those places at the same time. It may take hours to read the codebase and you could still miss some side-effect. When tests break after your changes, the problem could be anywhere in the codebase.</li>\n<li><strong>Many small changes:</strong> Plan a series of changes, each of which can be proven through local reasoning to not change behavior. Start the refactoring from one place and propagate it in tiny increments by making mechanical changes which require very little thinking. There could be 10 or 100 times more steps, but each of them takes just a couple seconds. When tests break after your changes, the problem should be near the line you changed 5 seconds ago.</li>\n</ul><p>Many small changes is faster than one big change.</p><p>When you refactor, don't change behavior. When you change behavior, don't refactor. Maintain three points of contact like a mountain climber. 🧗</p><recommended-reading><ul>\n<li><a href=\"https://www.infoq.com/presentations/responsive-design/\" target=\"_blank\" rel=\"noopener noreferrer\">Responsive Design</a></li>\n</ul></recommended-reading><h3 id=\"refactoring-hell\" style=\"position:relative;\">Refactoring hell<a href=\"#refactoring-hell\" aria-label=\"refactoring hell permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>If it's been more than a few minutes since the tests last passed, <code class=\"language-text\">git reset --hard</code> and try again using smaller steps.</p><p>(Your IDE's <a href=\"https://www.jetbrains.com/help/idea/local-history.html\" target=\"_blank\" rel=\"noopener noreferrer\">local history</a> may also show when all tests last passed, so you can revert to that point in time.)</p><recommended-reading><ul>\n<li><a href=\"https://wiki.c2.com/?RefactoringHell\" target=\"_blank\" rel=\"noopener noreferrer\">Refactoring Hell</a></li>\n</ul></recommended-reading><h2 id=\"four-strategies\" style=\"position:relative;\">Four strategies<a href=\"#four-strategies\" aria-label=\"four strategies permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>There are four strategies to refactor and design using small, safe steps:</p><ul>\n<li><strong>Leap:</strong> The change is small enough. Just do it.</li>\n<li><strong>Parallel:</strong> Build the new solution side-by-side with the old solution, until the new can replace the old.</li>\n<li><strong>Stepping stone:</strong> You want to build thing A, but if you built thing B first, that could make it easier to build thing A. (Beware of gold plating.)</li>\n<li><strong>Simplification:</strong> Solve a trivialized version of the problem first. 1×1 sudoku.</li>\n</ul><p>Design is scale-free. The <em>parallel change</em> strategy works the same way regardless of whether we're adding a new field to a class, or replacing the healthcare software system of a city.</p><recommended-reading><ul>\n<li><a href=\"https://www.infoq.com/presentations/responsive-design/\" target=\"_blank\" rel=\"noopener noreferrer\">Responsive Design</a></li>\n</ul></recommended-reading><h2 id=\"test-quality\" style=\"position:relative;\">Test quality<a href=\"#test-quality\" aria-label=\"test quality permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Tests should be sensitive to behavior changes and insensitive to structure changes.</p><p>Each test should test only one thing.</p><p>Each bug should cause only one test to fail.</p><p>From the pattern of failing tests, it should be possible to guess in which function or line the problem is.</p><p>If some code can be commented out and no test fails, the code should be dead.</p><p>In five seconds you will have forgotten over half of your <a href=\"https://en.wikipedia.org/wiki/Working_memory\" target=\"_blank\" rel=\"noopener noreferrer\">working memory</a>. Make the tests so fast that you won't forget what you were thinking.</p><p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 1rem;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.86956521739131%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVR42pWSVw6DQAxE9/5nBIkOorfQCXlgglCKQvyBjHdnPGOvWpal7/skSbquu23RNE1d15J8rLRtWxQFXwW4LEvTNEnmeb5fCG4Kywr2PM+2bZDL5UAmeJWmKRpojozr+B3sOE4YhliapgklF8F0WmVHUYRmmlPifxiGPzpbllVVFRklhuH7PqzHYH6ANU3TdT3LMgGzNg7Ax3Gc57lcfSfaZbOkc+fjGBbZ7TiOXztzA9vi+V0t8wcfBMELxd6ZjG3R/KO8w0v7DGGRihINeGZVlIZTcE8SjsYtGCd7RTDvynXdFQwS5zBVW3DGtHjt5DweKRqGgTV5/ziFArwSYXC/WKXILFgk3WRsZ1PkKHoArP0w5Q4jD5oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/460a7c0c4db93ce8d1fe133754cd3c0e/a0b58/working-memory-decay.webp 230w,\n/static/460a7c0c4db93ce8d1fe133754cd3c0e/bc10c/working-memory-decay.webp 460w,\n/static/460a7c0c4db93ce8d1fe133754cd3c0e/9cb26/working-memory-decay.webp 539w\"\n              sizes=\"(max-width: 539px) 100vw, 539px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/460a7c0c4db93ce8d1fe133754cd3c0e/81c8e/working-memory-decay.png 230w,\n/static/460a7c0c4db93ce8d1fe133754cd3c0e/08a84/working-memory-decay.png 460w,\n/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png 539w\"\n            sizes=\"(max-width: 539px) 100vw, 539px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/460a7c0c4db93ce8d1fe133754cd3c0e/10f9a/working-memory-decay.png\"\n            alt=\"Decay of working memory if rehearsal is prevented. The time scale is of the order of a few seconds.\"\n            title=\"How quickly working memory decays when you think of something else. [[1]](https://www.researchgate.net/figure/Decay-of-working-memory-if-rehearsal-is-prevented-The-time-scale-is-of-the-order-of-a_fig7_35883885)\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>How quickly working memory decays when you think of something else. <a href=\"https://www.researchgate.net/figure/Decay-of-working-memory-if-rehearsal-is-prevented-The-time-scale-is-of-the-order-of-a_fig7_35883885\" target=\"_blank\" rel=\"noopener noreferrer\">[1]</a></p></figcaption>\n  </figure></p><recommended-reading><ul>\n<li><a href=\"https://agileinaflash.blogspot.com/2009/02/first.html\" target=\"_blank\" rel=\"noopener noreferrer\">F.I.R.S.T properties of unit tests</a></li>\n<li><a href=\"https://medium.com/@kentbeck_7670/programmer-test-principles-d01c064d7934\" target=\"_blank\" rel=\"noopener noreferrer\">Programmer Test Principles</a></li>\n</ul></recommended-reading><h3 id=\"test-smells\" style=\"position:relative;\">Test smells<a href=\"#test-smells\" aria-label=\"test smells permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>Like there are <a href=\"https://refactoring.guru/refactoring/smells\" target=\"_blank\" rel=\"noopener noreferrer\">many code smells</a>, there are also <a href=\"http://xunitpatterns.com/TestSmells.html\" target=\"_blank\" rel=\"noopener noreferrer\">test smells</a>. Here are a couple to look out for:</p><p><strong>Many asserts per test:</strong> Normally tests are structured in the <a href=\"https://agileinaflash.blogspot.com/2009/03/arrange-act-assert.html\" target=\"_blank\" rel=\"noopener noreferrer\">Arrange-Act-Assert</a>/<a href=\"https://dannorth.net/introducing-bdd/\" target=\"_blank\" rel=\"noopener noreferrer\">Given-When-Then</a>/<a href=\"https://en.wikipedia.org/wiki/Hoare_logic\" target=\"_blank\" rel=\"noopener noreferrer\">Hoare Triple</a> format. But if they are instead <em>Arrange-Act-Assert-Act-Assert-Act...</em>, that usually indicates that a test is lacking focus and testing many different things (making the test's purpose harder to decipher), or that it's testing <em>how</em> the system does things instead of testing <em>what</em> the system does (making refactoring harder). Depending on the testing framework, earlier test failures may also mask later test failures, making it harder to know why the test failed. Instead, write many small, focused tests.</p><p><strong>Complex test setup:</strong> If the <em>arrange</em> part of a test is long, requiring the careful arrangement of many collaborators to get the system into the desired initial state for the test, it may indicate design problems in the code. Lots of constructor arguments is a similar smell (which is why dependency injection frameworks are best avoided - they make it too easy to add dependencies). Instead, try to think of a design which eliminates some of the dependencies.</p><hr><p>Proceed to <a href=\"/3-challenges\">Chapter 3: The Untestables</a> or <a href=\"/exercises\">Exercises</a></p></div>","frontmatter":{"path":"/2-design","title":"Chapter 2: Refactoring and design","banner":null},"fileAbsolutePath":"/Users/esko/devel/tdd-mooc/data/2-design.md"}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}